(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a36a775"],{"3e35":function(e,t,n){"use strict";n("7bd3")},"46f9":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-tabs",{attrs:{"tab-position":e.getWidth<920?"right":"top","default-active-key":e.activeTab?e.activeTab:e.activePage},on:{change:function(t){return e.activeTab?e.$emit("setActiveNomination",t):e.$router.push("/profile/"+t)}}},e._l(e.tabs?e.tabs:e.routerTabs,(function(e){return n("a-tab-pane",{key:e.id,attrs:{tab:e.name}})})),1)},a=[],r=(n("a9e3"),{data:function(){return{windowWidth:window.innerWidth}},computed:{getWidth:function(){return this.windowWidth}},mounted:function(){window.addEventListener("resize",this.onResize)},beforeDestroy:function(){window.removeEventListener("resize",this.onResize)},methods:{onResize:function(){this.windowWidth=window.innerWidth}}}),s={mixins:[r],props:{tabs:{type:Array},activeTab:{type:null|Number}},data:function(){return{routerTabs:[{name:"Основные сведения",id:"edit"},{name:"Анкета участника",id:"questionnaire"},{name:"Прикрепленные документы",id:"achievements"}]}},computed:{activePage:function(){return this.$route.meta.tabName}}},o=s,c=n("2877"),u=Object(c["a"])(o,i,a,!1,null,"06d32528",null);t["a"]=u.exports},"498a":function(e,t,n){"use strict";var i=n("23e7"),a=n("58a8").trim,r=n("c8d2");i({target:"String",proto:!0,forced:r("trim")},{trim:function(){return a(this)}})},"5c7b":function(e,t,n){"use strict";n("c155")},"7bd3":function(e,t,n){},"8e02":function(e,t,n){"use strict";n("f470")},9655:function(e,t,n){"use strict";n("9ec9")},"9ec9":function(e,t,n){},bb8d:function(e,t,n){"use strict";var i=n("1da1"),a=n("ade3"),r=(n("d3b7"),n("3ca3"),n("ddb0"),n("d81d"),n("ac1f"),n("1276"),n("c740"),n("498a"),n("96cf"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"document-container"},[n("h6",{staticClass:"document-title"},[e._v(" "+e._s(e.indicator.id)+" "+e._s(e.indicator.name)+" ")]),e.indicator.hint_text?n("div",{staticClass:"document-clue"},[e._v(" "+e._s(e.indicator.hint_text)+" ")]):e._e(),n("div",[n("ol",{staticClass:"achievement-list"},[e._l(e.indicator.achievements,(function(t,i){return n("upload-achievements-item-info",{key:t.id,attrs:{formName:"form1",position:i+1,participationDegree:e.participationDegree,setFiles:e.setFiles,item:t,disabled:!0,indicator:e.indicator},on:{remove:function(t){return e.$emit("remove",t)}}})})),n("x-form",{attrs:{name:"form1",values:e.form1},on:{submit:function(t){return e.submit("form1",e.indicator.id)}},model:{value:e.form1,callback:function(t){e.form1=t},expression:"form1"}},[n("upload-achievements-item",{key:e.achievements.length+1,attrs:{formName:"form1",setFiles:e.setFiles,position:e.achievements.length+1,participationDegree:e.participationDegree,indicator:e.indicator}})],1)],2)])])}),s=[],o=n("5530"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"file-container"},[n("div",{staticClass:"file-container__files"},e._l(e.files,(function(t){return n("div",{key:t.name,staticClass:"file-container__files--file"},[n("v-icon",{attrs:{name:"file"}}),n("span",[e._v(e._s(t.name))]),n("v-icon",{staticClass:"remove",attrs:{name:"times"},on:{click:e.removeFiles}})],1)})),0),n("FormulateInput",{staticClass:"document-uploader user-upload not-active achievement",attrs:{"label-class":"document-label",name:"file",type:"file",validation:"download","validation-rules":{download:function(t){t.value;return e.files.length}},"validation-messages":{download:"Загрузите документ"}},scopedSlots:e._u([{key:"element",fn:function(){return[n("input",{staticClass:"document-uploader--input",attrs:{type:"file",multiple:e.multiple,id:"upload",accept:"application/pdf",isDrag:e.dragHover},on:{dragover:function(t){e.dragHover=!0},dragleave:function(t){e.dragHover=!1},dragend:function(t){e.dragHover=!1},drop:function(t){e.dragHover=!1,e.uploadFile()},change:e.setFile}}),n("label",{staticClass:"document-uploader--custom",attrs:{name:"file",for:"upload"}},[n("v-icon",{attrs:{name:"file"}}),n("span",[e._v(e._s(e.getLabel))])],1)]},proxy:!0}])})],1)},u=[],l={props:{multiple:{type:Boolean}},data:function(){return{dragHover:!1,uploadPercentage:0,files:[]}},computed:{getLabel:function(){return this.dragHover?"Перетащите сюда":"Прикрепить файл"}},methods:{removeFiles:function(){this.files=[]},setFile:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.files=e.target.files,t.$emit("change",t.files[0]);case 2:case"end":return n.stop()}}),n)})))()}}},m=l,d=n("2877"),p=Object(d["a"])(m,c,u,!1,null,"6fa22bf6",null),f=p.exports,v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{staticClass:"achievement-list__item"},[n("div",{staticClass:"achievement-list__item--info"},[n("div",{staticClass:"achievement-list__item--info--block"},[n("span",{staticClass:"count"},[e._v(e._s(e.position))]),n("x-input",{staticClass:"item-name",attrs:{name:"name",type:"text",validation:"required",label:"Название достижения"}}),e.indicator.degree_participation?n("x-input",{staticClass:"item-participation",attrs:{name:"degree_participation",type:"select",validation:"required",options:e.participationDegree,label:"Степень участия"}}):e._e(),n("x-input",{staticClass:"item-period",attrs:{name:"period",type:"select",validation:"required",options:e.getPeriod,label:"Год"}})],1),n("div",{staticClass:"achievement-list__item--info--block"},[e.indicator.url?n("x-input",{staticStyle:{width:"100%"},attrs:{type:"url",name:"url",validation:"required",label:"Вставьте ссылку на видео"}}):e._e()],1),n("div",{staticClass:"achievement-list__item--info--block"},[e.indicator.document?n("file-component",{on:{change:function(t){return e.setFiles(t,e.formName)}}}):e._e()],1),n("a-button",{staticClass:"document-container-button",attrs:{type:"info",block:"","html-type":"submit"}},[n("v-icon",{attrs:{name:"plus"}}),n("span",[e._v("Добавить")])],1)],1)])},h=[],_=(n("a9e3"),{components:{FileComponent:f},props:{participationDegree:{type:Array,required:!0},position:{type:Number,required:!0},setFiles:{type:Function,required:!1},formName:{type:String,required:!1},indicator:{type:Object,required:!0}},computed:{getPeriod:function(){for(var e=this.indicator.period,t=e.start_achievement,n=e.finish_achievement,i=[],a=t;a<=n;a++)i.push(a);return i}}}),g=_,b=(n("9655"),Object(d["a"])(g,v,h,!1,null,"a8a8c6d2",null)),w=b.exports,y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{staticClass:"achievement-list__item"},[n("div",{staticClass:"achievement-list__item--read"},[n("div",{staticClass:"achievement-list__item--tools"},[n("span",{staticClass:"count"},[e._v(e._s(e.position))]),n("a-tooltip",{attrs:{placement:"top"}},[n("template",{slot:"title"},[n("span",[e._v("Удалить достижение")])]),n("v-icon",{staticClass:"remove",attrs:{name:"times"},on:{click:e.deleteAchievement}})],2)],1),n("div",{staticClass:"achievement-list__item--read--item item-name"},[n("span",[e._v("Название достижения")]),n("span",[e._v(e._s(e.item.name))])]),n("div",{staticClass:"achievement-list__item--read--item item-participation"},[n("span",[e._v("Степень участия")]),n("span",[e._v(e._s(e.item.degree_participation))])]),n("div",{staticClass:"achievement-list__item--read--item item-period"},[n("span",[e._v("Год")]),n("span",[e._v(e._s(e.item.period))])])]),e.item.url?n("div",{staticClass:"achievement-list__item--read--item"},[n("span",[e._v("Ссылка на видео")]),n("a",{attrs:{href:e.item.url,target:"_blank"}},[e._v(e._s(e.item.url))])]):e._e(),e.item.document?n("div",{staticClass:"file-container"},[n("div",{staticClass:"file-container__files"},[n("a",{staticClass:"file-container__files--file",attrs:{href:e.getDocumentLink,target:"_blank"}},[n("v-icon",{attrs:{name:"file"}}),n("span",[e._v(e._s(e.item.documentName))])],1)])]):e._e()])},x=[],C=(n("99af"),Object({VUE_APP_API_PATH:"/api/v1",VUE_APP_API_HOST:"http://176.119.147.179",VUE_APP_API_PORT:"8000",NODE_ENV:"production",BASE_URL:"/"})),k=C.VUE_APP_API_PORT,O=C.VUE_APP_API_HOST,N={components:{FileComponent:f},data:function(){return{port:k,host:O}},props:{participationDegree:{type:Array,required:!0},position:{type:Number,required:!0},setFiles:{type:Function,required:!1},formName:{type:String,required:!1},item:{type:Object,required:!0}},computed:{getDocumentLink:function(){return"".concat(this.host,":").concat(this.port,"/media/").concat(this.item.document)}},methods:{deleteAchievement:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$swal.fire({title:"Вы точно хотите удалить достижение?",showCancelButton:!0});case 2:n=e.sent,i=n.isConfirmed,i&&t.$emit("remove",t.item.id);case 5:case"end":return e.stop()}}),e)})))()}}},A=N,R=(n("8e02"),Object(d["a"])(A,y,x,!1,null,"59c1ea8e",null)),j=R.exports,F={components:{UploadAchievementsItem:w,FileComponent:f,UploadAchievementsItemInfo:j},props:{achievements:{type:Array,required:!0},participationDegree:{type:Array,required:!0},indicator:{type:Object,required:!0},saveAchievement:{type:Function,required:!0}},data:function(){return{form1:{},form2:{},form3:{}}},methods:{setFiles:function(e,t){this[t].document=e},submit:function(e,t){var n=this;return Object(i["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return console.log(n[e]),i.next=3,n.saveAchievement(Object(o["a"])(Object(o["a"])({},n[e]),{},{indicators:t}));case 3:n.form1={};case 4:case"end":return i.stop()}}),i)})))()}}},P=F,D=(n("3e35"),n("5c7b"),Object(d["a"])(P,r,s,!1,null,null,null)),$=D.exports,E=n("46f9"),I=(n("cd3f"),n("09bc")),q=n("5b55");t["a"]={components:{Upload:$,ComponentTabs:E["a"]},data:function(){var e;return e={loading:!0,participationDegree:I["h"],buttonDisabled:!1},Object(a["a"])(e,"loading",!1),Object(a["a"])(e,"indicators",[]),Object(a["a"])(e,"activeNomination",null),e},computed:{userInfo:function(){return this.$store.state.user.userInfo},initialIndicators:function(){return this.$store.state.app.indicator},getMessage:function(){switch("create"){case"create":return"Успешно создано";case"edit":return"Успешно сохранено"}}},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.activeNomination=e.userInfo.nomination[0].id,t.next=3,e.changeNomination();case 3:case"end":return t.stop()}}),t)})))()},methods:{changeNomination:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.getIndicatorsByNomination(e.activeTab);case 3:return t.next=5,e.getAchievementsToIndicators(e.initialIndicators);case 5:e.indicators=t.sent,console.log(e.indicators),e.loading=!1;case 8:case"end":return t.stop()}}),t)})))()},getIndicatorsByNomination:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$store.dispatch("app/getEntities",{entityName:q["b"],params:{nomination:e}});case 3:n.next=8;break;case 5:n.prev=5,n.t0=n["catch"](0),console.log(n.t0);case 8:case"end":return n.stop()}}),n,null,[[0,5]])})))()},getAchievementsToIndicators:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Promise.all(e.map((function(e){return new Promise(function(){var n=Object(i["a"])(regeneratorRuntime.mark((function n(i){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$store.dispatch("app/getEntities",{entityName:q["a"],params:{indicator:e.id}});case 2:a=n.sent,console.log(a),e.achievements=a.data.map((function(e){return e.document&&(e.documentName=t.addDocumentName(e.document)),e})),i(e);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())})));case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},getFormData:function(e){var t=new FormData;for(var n in e)t.append(n,e[n]);return t},saveAchievement:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=t.getFormData(e),n.next=3,t.saveEntity(i);case 3:case"end":return n.stop()}}),n)})))()},saveEntity:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,t.buttonDisabled=!0,n.next=4,t.$store.dispatch("app/saveEntity",{data:e,method:"post",entityName:q["a"]});case 4:i=n.sent,t.addNewFields(i),t.$notification.success({message:t.getMessage}),n.next=13;break;case 9:n.prev=9,n.t0=n["catch"](0),console.log(n.t0),t.$errors.showOnce(n.t0.response.data);case 13:return n.prev=13,t.buttonDisabled=!1,n.finish(13);case 16:case"end":return n.stop()}}),n,null,[[0,9,13,16]])})))()},addDocumentName:function(e){if(e){var t=e.split("/");return t[t.length-1]}},addNewFields:function(e){e.document&&(e.documentName=this.addDocumentName(e.document));var t=this.indicators.findIndex((function(t){return e.indicators===t.id})),n=this.indicators[t];n.achievements.push(e),console.log(this.indicators)},removeAchievement:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.loading=!0,n.prev=1,n.next=4,t.$store.dispatch("app/deleteItem",{entityName:q["a"],id:e});case 4:return n.next=6,t.changeNomination();case 6:t.$swal("Успешно удалено!"),n.next=13;break;case 9:n.prev=9,n.t0=n["catch"](1),console.log(n.t0),t.$errors.showOnce(n.t0.response.data);case 13:return n.prev=13,t.loading=!1,n.finish(13);case 16:case"end":return n.stop()}}),n,null,[[1,9,13,16]])})))()},editAchievement:function(){},trimWhitespaces:function(e){for(var t in e)e[t]===String&&e[t].trim()},onApplicate:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$swal.fire({title:"Отправить завку на конкурс? После подтверждения действия Вы не сможете редактировать введенные данные",inputLabel:"Your email address",showCancelButton:!0});case 2:n=t.sent,n.isConfirmed;case 4:case"end":return t.stop()}}),t)})))()}}}},c155:function(e,t,n){},c8d2:function(e,t,n){var i=n("d039"),a=n("5899"),r="​᠎";e.exports=function(e){return i((function(){return!!a[e]()||r[e]()!=r||a[e].name!==e}))}},f470:function(e,t,n){}}]);
//# sourceMappingURL=chunk-5a36a775.fe801f3d.js.map