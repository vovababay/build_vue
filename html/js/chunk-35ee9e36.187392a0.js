(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-35ee9e36"],{"10d9":function(e,t,n){},"3e35":function(e,t,n){"use strict";n("7bd3")},"46f9":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-tabs",{attrs:{"tab-position":e.getWidth<920?"right":"top","default-active-key":e.activeTab?e.activeTab:e.activePage},on:{change:function(t){return e.activeTab?e.$emit("setActiveNomination",t):e.$router.push("/profile/"+t)}}},e._l(e.tabs?e.tabs:e.routerTabs,(function(e){return n("a-tab-pane",{key:e.id,attrs:{tab:e.name}})})),1)},a=[],r=(n("a9e3"),{data:function(){return{windowWidth:window.innerWidth}},computed:{getWidth:function(){return this.windowWidth}},mounted:function(){window.addEventListener("resize",this.onResize)},beforeDestroy:function(){window.removeEventListener("resize",this.onResize)},methods:{onResize:function(){this.windowWidth=window.innerWidth}}}),o={mixins:[r],props:{tabs:{type:Array},activeTab:{type:null|Number}},data:function(){return{routerTabs:[{name:"Основные сведения",id:"edit"},{name:"Прикрепленные документы",id:"achievements"}]}},computed:{activePage:function(){return this.$route.meta.tabName}}},s=o,c=n("2877"),u=Object(c["a"])(s,i,a,!1,null,"442d747e",null);t["a"]=u.exports},"498a":function(e,t,n){"use strict";var i=n("23e7"),a=n("58a8").trim,r=n("c8d2");i({target:"String",proto:!0,forced:r("trim")},{trim:function(){return a(this)}})},"5c7b":function(e,t,n){"use strict";n("c155")},"7bd3":function(e,t,n){},"7db0":function(e,t,n){"use strict";var i=n("23e7"),a=n("b727").find,r=n("44d2"),o="find",s=!0;o in[]&&Array(1)[o]((function(){s=!1})),i({target:"Array",proto:!0,forced:s},{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),r(o)},b48b:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"file-container"},[n("div",{staticClass:"file-container__files"},e._l(e.files,(function(t){return n("div",{key:t.name,staticClass:"file-container__files--file"},[n("v-icon",{attrs:{name:"file"}}),n("span",[e._v(e._s(t.name))]),n("v-icon",{staticClass:"remove",attrs:{name:"times"},on:{click:function(n){return e.removeFiles(t)}}})],1)})),0),n("FormulateInput",{staticClass:"document-uploader user-upload not-active achievement",attrs:{"label-class":"document-label",name:"document",type:"file",validation:"mime:"+e.acceptFormat.join(",")+"|download","validation-rules":{download:function(t){t.value;return e.files.length}},"validation-messages":{download:"Загрузите документ"}},scopedSlots:e._u([{key:"element",fn:function(){return[n("input",{ref:"files",staticClass:"document-uploader--input",attrs:{type:"file",multiple:!1,id:"upload",accept:e.acceptFormat.join(","),isDrag:e.dragHover},on:{dragover:function(t){e.dragHover=!0},dragleave:function(t){e.dragHover=!1},dragend:function(t){e.dragHover=!1},drop:e.setFile,change:e.setFile}}),n("label",{staticClass:"document-uploader--custom",attrs:{name:"file",for:"upload"}},[n("v-icon",{attrs:{name:"file"}}),n("span",[e._v(e._s(e.getLabel))])],1)]},proxy:!0}])})],1)},a=[],r=n("1da1"),o=(n("96cf"),n("a434"),n("c740"),n("b0c0"),n("159b"),n("7db0"),n("caad"),n("2532"),{props:{multiple:{type:Boolean}},data:function(){return{dragHover:!1,uploadPercentage:0,files:[],acceptFormat:["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"]}},computed:{getLabel:function(){return this.dragHover?"Перетащите сюда":"Прикрепить файл"}},methods:{removeFiles:function(e){this.files.splice(this.files.findIndex((function(t){return t.name===e.name})),1)},setFile:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.dragHover=!1,!t.multiple){n.next=6;break}e.target.files.forEach((function(e,n){t.files.find((function(t){return console.log(t,e),t.name===e.name})),t.files.find((function(t){return t.name===e.name}))||(t.acceptFormat.includes(e.type)?t.files.push(e):t.$toast.error("Неккоректный формат"))})),t.$emit("change",t.files),n.next=16;break;case 6:if(i=e.target.files,i.length){n.next=9;break}return n.abrupt("return");case 9:if(console.log(i[0]),t.acceptFormat.includes(i[0].type)){n.next=12;break}return n.abrupt("return");case 12:t.files=[e.target.files[0]],t.$refs.files.value=null,console.log(t.files),t.$emit("change",t.files[0]);case 16:case"end":return n.stop()}}),n)})))()}}}),s=o,c=n("2877"),u=Object(c["a"])(s,i,a,!1,null,"11048ff8",null);t["a"]=u.exports},bb8d:function(e,t,n){"use strict";var i=n("1da1"),a=n("ade3"),r=(n("d3b7"),n("3ca3"),n("ddb0"),n("d81d"),n("ac1f"),n("1276"),n("c740"),n("498a"),n("96cf"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"document-container"},[n("h6",{staticClass:"document-title"},[e._v(" "+e._s(e.indicator.name)+" ")]),e.indicator.hint_text?n("div",{staticClass:"document-clue"},[e._v(" "+e._s(e.indicator.hint_text)+" ")]):e._e(),n("div",[n("ol",{staticClass:"achievement-list"},[e._l(e.indicator.achievements,(function(t,i){return n("upload-achievements-item-info",{key:t.id,attrs:{position:i+1,participationDegree:e.participationDegree,setFiles:e.setFiles,item:t,disabled:!0,indicator:e.indicator},on:{remove:function(t){return e.$emit("remove",t)}}})})),n("x-form",{attrs:{values:e.form,name:"achievement"},on:{submit:function(t){return e.submit(e.indicator.id)}},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[n("upload-achievements-item",{key:e.achievements.length+1,attrs:{setFiles:e.setFiles,position:e.achievements.length+1,participationDegree:e.participationDegree,indicator:e.indicator}})],1)],2)])])}),o=[],s=n("5530"),c=n("b48b"),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{staticClass:"achievement-list__item"},[e.isVisible?e._e():n("div",{staticClass:"achievement-list__item--info"},[n("div",{staticClass:"achievement-list__item--info--block"},[n("span",{staticClass:"count"},[e._v(e._s(e.position))]),n("x-input",{staticClass:"item-name",attrs:{name:"name",type:"text",validation:"required",label:"Название достижения","error-behavior":"submit"}}),e.indicator.degree_participation?n("x-input",{staticClass:"item-participation",attrs:{name:"degree_participation",type:"select",validation:"required",options:e.participationDegree,label:"Степень участия","error-behavior":"submit"}}):e._e(),n("x-input",{staticClass:"item-period",attrs:{name:"period",type:"select",validation:"required",options:e.getPeriod,label:"Год","error-behavior":"submit"}})],1),n("div",{staticClass:"achievement-list__item--info--block"},[e.indicator.url?n("x-input",{staticStyle:{width:"100%"},attrs:{type:"url",name:"url",validation:"required",label:"Вставьте ссылку на видео","error-behavior":"submit"}}):e._e()],1),n("div",{staticClass:"achievement-list__item--info--block"},[e.indicator.document?n("file-component",{on:{change:function(t){return e.setFiles(t)}}}):e._e()],1),n("a-button",{staticClass:"document-container-button",attrs:{type:"info",block:"","html-type":"submit"}},[n("v-icon",{attrs:{name:"plus"}}),n("span",[e._v("Добавить")])],1)],1)])},l=[],m=(n("a9e3"),{components:{FileComponent:c["a"]},props:{participationDegree:{type:Array,required:!0},position:{type:Number,required:!0},setFiles:{type:Function,required:!1},indicator:{type:Object,required:!0}},computed:{isVisible:function(){return this.indicator.max_count_achievement===this.indicator.achievements.length},getPeriod:function(){for(var e=this.indicator.period,t=e.start_achievement,n=e.finish_achievement,i=[],a=t;a<=n;a++)i.push(a);return i}}}),d=m,p=(n("ea3b"),n("2877")),f=Object(p["a"])(d,u,l,!1,null,"2d2dc990",null),v=f.exports,h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{staticClass:"achievement-list__item"},[n("div",{staticClass:"achievement-list__item--read"},[n("div",{staticClass:"achievement-list__item--tools"},[n("span",{staticClass:"count"},[e._v(e._s(e.position))]),n("a-tooltip",{attrs:{placement:"top"}},[n("template",{slot:"title"},[n("span",[e._v("Удалить достижение")])]),n("v-icon",{staticClass:"remove",attrs:{name:"times"},on:{click:e.deleteAchievement}})],2)],1),n("div",{staticClass:"achievement-list__item--read--item item-name"},[n("span",[e._v(e._s(e.item.name))])]),e.item.degree_participation?n("div",{staticClass:"achievement-list__item--read--item item-participation"},[n("span",[e._v(e._s(e.item.degree_participation))])]):e._e(),n("div",{staticClass:"achievement-list__item--read--item item-period"},[n("span",[e._v(e._s(e.item.period))])])]),e.item.url?n("div",{staticClass:"achievement-list__item--read--item"},[n("a",{attrs:{href:e.item.url,target:"_blank"}},[e._v(e._s(e.item.url))])]):e._e(),e.item.document?n("div",{staticClass:"file-container"},[n("div",{staticClass:"file-container__files"},[n("a",{staticClass:"file-container__files--file",attrs:{href:e.getDocumentLink,target:"_blank"}},[n("v-icon",{attrs:{name:"file"}}),n("span",[e._v(e._s(e.item.documentName))])],1)])]):e._e()])},b=[],g=(n("99af"),"https://студентгода63.рф/media"),_={components:{FileComponent:c["a"]},data:function(){return{media:g}},props:{participationDegree:{type:Array,required:!0},position:{type:Number,required:!0},setFiles:{type:Function,required:!1},item:{type:Object,required:!0}},computed:{getDocumentLink:function(){return"".concat(this.media,"/").concat(this.item.document)}},methods:{deleteAchievement:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$swal.fire({title:"Вы точно хотите удалить достижение?",showCancelButton:!0});case 2:n=t.sent,i=n.isConfirmed,i&&e.$emit("remove",e.item.id);case 5:case"end":return t.stop()}}),t)})))()}}},w=_,x=(n("d6cc"),Object(p["a"])(w,h,b,!1,null,"42b772b9",null)),y=x.exports,C={components:{UploadAchievementsItem:v,FileComponent:c["a"],UploadAchievementsItemInfo:y},props:{achievements:{type:Array,required:!0},participationDegree:{type:Array,required:!0},indicator:{type:Object,required:!0},saveAchievement:{type:Function,required:!0}},data:function(){return{form:{}}},methods:{setFiles:function(e){this.form.document=e},submit:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.saveAchievement(Object(s["a"])(Object(s["a"])({},t.form),{},{indicators:e}));case 2:t.form={};case 3:case"end":return n.stop()}}),n)})))()}}},k=C,F=(n("3e35"),n("5c7b"),Object(p["a"])(k,r,o,!1,null,null,null)),j=F.exports,R=n("46f9"),O=(n("cd3f"),n("09bc")),$=n("5b55");t["a"]={components:{Upload:j,ComponentTabs:R["a"]},data:function(){var e;return e={loading:!0,participationDegree:O["j"],buttonDisabled:!1},Object(a["a"])(e,"loading",!1),Object(a["a"])(e,"indicators",[]),Object(a["a"])(e,"activeNomination",null),e},computed:{userInfo:function(){return this.$store.state.user.userInfo},initialIndicators:function(){return this.$store.state.app.indicator},getMessage:function(){switch("create"){case"create":return"Успешно создано";case"edit":return"Успешно сохранено"}}},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.changeNomination(e.userInfo.nomination[0].id);case 2:case"end":return t.stop()}}),t)})))()},methods:{changeNomination:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.loading=!0,t.activeNomination=e,n.next=4,t.getIndicatorsByNomination(t.activeNomination);case 4:return n.next=6,t.getAchievementsToIndicators(t.initialIndicators);case 6:t.indicators=n.sent,console.log(t.indicators),t.loading=!1;case 9:case"end":return n.stop()}}),n)})))()},getIndicatorsByNomination:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$store.dispatch("app/getEntities",{entityName:$["b"],params:{nomination:e}});case 3:n.next=8;break;case 5:n.prev=5,n.t0=n["catch"](0),console.log(n.t0);case 8:case"end":return n.stop()}}),n,null,[[0,5]])})))()},getAchievementsToIndicators:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Promise.all(e.map((function(e){return new Promise(function(){var n=Object(i["a"])(regeneratorRuntime.mark((function n(i){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$store.dispatch("app/getEntities",{entityName:$["a"],params:{indicator:e.id}});case 2:a=n.sent,console.log(a),e.achievements=a.data.map((function(e){return e.document&&(e.documentName=t.addDocumentName(e.document)),e})),i(e);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())})));case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},getFormData:function(e){var t=new FormData;for(var n in e)t.append(n,e[n]);return t},saveAchievement:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=t.getFormData(e),n.next=3,t.saveEntity(i);case 3:case"end":return n.stop()}}),n)})))()},saveEntity:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,t.buttonDisabled=!0,n.next=4,t.$store.dispatch("app/saveEntity",{data:e,method:"post",entityName:$["a"]});case 4:i=n.sent,t.addNewFields(i),t.$notification.success({message:t.getMessage}),n.next=13;break;case 9:n.prev=9,n.t0=n["catch"](0),console.log(n.t0),t.$formulate.handle(n.t0.response.data,"achievement");case 13:return n.prev=13,t.buttonDisabled=!1,n.finish(13);case 16:case"end":return n.stop()}}),n,null,[[0,9,13,16]])})))()},addDocumentName:function(e){if(e){var t=e.split("/");return t[t.length-1]}},addNewFields:function(e){e.document&&(e.documentName=this.addDocumentName(e.document));var t=this.indicators.findIndex((function(t){return e.indicators===t.id})),n=this.indicators[t];n.achievements.push(e),console.log(this.indicators)},removeAchievement:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.loading=!0,n.prev=1,n.next=4,t.$store.dispatch("app/deleteItem",{entityName:$["a"],id:e});case 4:return n.next=6,t.changeNomination();case 6:t.$swal("Успешно удалено!"),n.next=13;break;case 9:n.prev=9,n.t0=n["catch"](1),console.log(n.t0),t.$errors.showOnce(n.t0.response.data);case 13:return n.prev=13,t.loading=!1,n.finish(13);case 16:case"end":return n.stop()}}),n,null,[[1,9,13,16]])})))()},editAchievement:function(){},trimWhitespaces:function(e){for(var t in e)e[t]===String&&e[t].trim()},onApplicate:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$swal.fire({title:"Отправить завку на конкурс? После подтверждения действия Вы не сможете редактировать введенные данные",inputLabel:"Your email address",showCancelButton:!0});case 2:n=t.sent,n.isConfirmed;case 4:case"end":return t.stop()}}),t)})))()}}}},c155:function(e,t,n){},c8d2:function(e,t,n){var i=n("d039"),a=n("5899"),r="​᠎";e.exports=function(e){return i((function(){return!!a[e]()||r[e]()!=r||a[e].name!==e}))}},d6cc:function(e,t,n){"use strict";n("10d9")},ea3b:function(e,t,n){"use strict";n("f12b")},f12b:function(e,t,n){}}]);
//# sourceMappingURL=chunk-35ee9e36.187392a0.js.map