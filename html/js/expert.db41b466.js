(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["expert"],{"066a":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("x-crud",{attrs:{loading:t.loading}},[n("div",{staticClass:"container profile-info"},[t.userInfo?n("a-row",{attrs:{gutter:[24]}},[n("a-col",{staticClass:"center",attrs:{xs:{span:24,offset:0},md:{span:22,offset:1},lg:{span:22,offset:1},xl:{span:22,offset:1}}},[n("div",{staticClass:"head"},[n("div",{staticClass:"head__info"},[n("h2",[t._v(t._s(t.getFullName))])])]),n("profile-nomination",{attrs:{nominations:t.userInfo.expert_nomination}}),t._l(t.infos,(function(e,a){return n("profile-infoblock",{key:a,attrs:{userInfo:t.userInfo,data:e.info,title:e.title}})}))],2)],1):t._e()],1),n("div",{staticClass:"crud-form-button",staticStyle:{width:"200px",margin:"auto"}},[n("router-link",{attrs:{to:t.id?"/expert/edit/"+t.id:"/me/edit"}},[n("a-button",{attrs:{type:"primary",block:"","html-type":"submit"}},[t._v(" Редактировать ")])],1)],1)])},r=[],i=n("1da1"),s=(n("96cf"),n("a15b"),n("ac1f"),n("1276"),n("c1f9"),n("4de4"),n("4fad"),n("498a"),n("99af"),n("2dd8")),o=n("f729"),c=n("1359"),u=n("f60b"),l=n("09bc"),m=n("46f9"),p=n("c1df"),f=n.n(p),d="https://студентгода63.рф/media",b={props:["action","id"],mixins:[s["a"],o["a"]],components:{ProfileNomination:c["a"],ProfileInfoblock:u["a"],ComponentTabs:m["a"]},data:function(){return{educationPlace:l["g"],formData:{},media:d,entityName:"users",textareaMaxLength:255,infos:[{title:"Личные данные",info:[{name:"Номер телефона",key:"phone_number"},{name:"E-mail",key:"email"},{name:"Подтвержден как эксперт",key:"is_expert",render:function(t){return t?"Подтвержден":"Не подтвержден"}}]}]}},methods:{getBirthday:function(t){return t.split("-").reverse().join("-")}},created:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.id){e.next=3;break}return t.loading=!1,e.abrupt("return");case 3:if("create"===t.action){e.next=6;break}return e.next=6,t.getEntity();case 6:t.loading=!1;case 7:case"end":return e.stop()}}),e)})))()},computed:{userInfo:function(){return this.id?Object.fromEntries(Object.entries(this.formData).filter((function(t){return t[1]}))):this.$store.state.user.userInfo},getFullName:function(){var t=this.userInfo,e=t.first_name,n=t.last_name,a=t.patronymic;return"".concat(e," ").concat(n," ").concat(a||"").trim()},getAge:function(){return f()().diff(this.userInfo.date_birth,"years")}}},h=b,v=(n("6b58"),n("2877")),x=Object(v["a"])(h,a,r,!1,null,"5d25c605",null);e["default"]=x.exports},"11ff":function(t,e,n){"use strict";n("d12a")},"2dd8":function(t,e,n){"use strict";var a=n("5530"),r=n("1da1");n("498a"),n("99af"),n("96cf");e["a"]={data:function(){return{loading:!0,buttonDisabled:!1}},methods:{getEntity:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,e.loading=!0,n.next=4,e.$store.dispatch("app/getItem",{entityName:e.entityName,id:e.getID});case 4:if(r=n.sent,!t){n.next=7;break}return n.abrupt("return",r.data);case 7:e.formData=Object(a["a"])(Object(a["a"])({},e.formData),r.data),n.next=13;break;case 10:n.prev=10,n.t0=n["catch"](0),console.log(n.t0);case 13:case"end":return n.stop()}}),n,null,[[0,10]])})))()},trimWhitespaces:function(t){for(var e in t)t[e]===String&&t[e].trim()},saveEntity:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,e.buttonDisabled=!0,e.trimWhitespaces(e.formData),n.next=5,e.$store.dispatch("app/saveEntity",{id:e.getID,data:t||e.formData,method:e.method,entityName:e.entityName});case 5:a=n.sent,e.$toast.success(e.getMessage),e.$router.push("/".concat(e.entityName,"/read/").concat(a.id)),n.next=14;break;case 10:n.prev=10,n.t0=n["catch"](0),console.log(n.t0),e.$errors.showOnce(n.t0.response.data);case 14:return n.prev=14,e.buttonDisabled=!1,n.finish(14);case 17:case"end":return n.stop()}}),n,null,[[0,10,14,17]])})))()},deleteItem:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.loading=!0,n.prev=1,n.next=4,e.$store.dispatch("app/deleteItem",{entityName:e.entityName,id:t});case 4:e.$toast.success("Успешно удалено"),n.next=11;break;case 7:n.prev=7,n.t0=n["catch"](1),console.log(n.t0),e.$errors.showOnce(n.t0.response.data);case 11:return n.prev=11,e.loading=!1,n.finish(11);case 14:case"end":return n.stop()}}),n,null,[[1,7,11,14]])})))()}},computed:{disabled:function(){return"read"===this.action},getID:function(){if("_"!==this.id)return this.id},method:function(){switch(this.action){case"create":return"post";case"edit":return"patch";default:return null}},getButtonAction:function(){switch(this.action){case"create":return"Создать";case"read":return"Редактировать";case"edit":return"Сохранить"}},getAction:function(){switch(this.action){case"create":return"Создание";case"read":return"Просмотр";case"edit":return"Редактирование"}},getMessage:function(){switch(this.action){case"create":return"Успешно создано";case"edit":return"Успешно сохранено"}}}}},"3f49":function(t,e,n){},"6b58":function(t,e,n){"use strict";n("3f49")},"88d1":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("x-crud",[n("a-row",{attrs:{gutter:[24]}},[n("a-col",{staticClass:"center",attrs:{xs:{span:24,offset:0},md:{span:22,offset:1},lg:{span:22,offset:1},xl:{span:22,offset:1}}},[t.loading?t._e():n("x-form",{staticClass:"profile-application-container",attrs:{values:t.form,name:"application"},on:{submit:t.saveForm},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}},[n("div",{staticClass:"profile-form"},[n("application-form",{attrs:{isProfile:"",items:t.items}})],1),n("a-col",{staticClass:"inline-buttons",staticStyle:{width:"200px",margin:"auto","margin-top":"35px"},attrs:{md:{span:24,offset:0},xl:{span:14,offset:5},lg:{span:24,offset:0},xs:24}},[n("a-button",{staticClass:"login-form-button",attrs:{disabled:t.buttonDisabled,type:"primary",block:"","html-type":"submit"}},[t._v(" Сохранить ")])],1)],1)],1)],1)],1)},r=[],i=n("5530"),s=n("1da1"),o=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("d81d"),n("b0c0"),n("99af"),n("25f0"),n("2dd8")),c=n("d5f5"),u=n("1bd6"),l=n("c1df"),m=n.n(l),p=n("09de"),f=(n("09bc"),n("cd3f")),d=n.n(f),b=n("46f9"),h={props:["action","id"],mixins:[o["a"],c["a"]],components:{UploadPhoto:p["a"],ApplicationForm:u["a"],ComponentTabs:b["a"]},data:function(){var t=this;return{form:{},buttonDisabled:!1,users:null,entityName:"users",textareaMaxLength:255,nominationsAll:[],isAdmin:!1,items:[[{name:"first_name",validation:"required",type:"text",label:"Фамилия",md:12},{name:"last_name",validation:"required",type:"text",label:"Имя",md:12},{name:"patronymic",type:"text",label:"Отчество",md:24}],[{name:"email",validation:"required",type:"text",label:"Email"},{name:"phone_number",validation:[["required"],["min","18"]],mask:"+7 (###) ###-##-##",type:"tel",label:"Номер телефона",xl:16}],[{name:"expert_nominations",validation:"required",label:"Номинация",type:"vue-select",multiple:!0,disabled:!0,class:function(){return t.form.nomination.length>=1?"has-all":""},options:function(){return t.nominationsAll},xl:24,md:24},{name:"is_expert",visible:function(){return t.isAdmin},validation:"required",type:"radio",label:"Является экспертом",class:"inline-checkbox",options:[{label:"Да",value:"true"},{label:"Нет",value:"false"}]}]]}},methods:{setNominations:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.form.expert_nominations.map((function(t){return e.getNominations(t)})));case 2:n=t.sent,console.log(n),e.nominationsAll=n.map((function(t){return{label:t.data.name,value:"".concat(t.data.id)}}));case 5:case"end":return t.stop()}}),t)})))()},getNominations:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.abrupt("return",e.$store.dispatch("app/getItem",{entityName:"nomination",id:t}));case 4:n.prev=4,n.t0=n["catch"](0),console.log(n.t0);case 7:case"end":return n.stop()}}),n,null,[[0,4]])})))()},saveForm:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.buttonDisabled=!0,e.prev=1,n=d()(Object(i["a"])(Object(i["a"])({},t.form),{},{is_expert:"true"===t.form.is_expert})),e.next=5,t.$store.dispatch("app/saveEntity",{entityName:"users",data:n,method:"patch",id:n.id});case 5:return e.next=7,t.$store.dispatch("user/getUserData");case 7:t.$toast.success("Успешно сохранено"),t.$router.push("/expert/read/".concat(t.id)),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](1),console.log(e.t0),400===(null===e.t0||void 0===e.t0||null===(a=e.t0.response)||void 0===a?void 0:a.status)&&t.$errors.show(e.t0.response.data);case 15:return e.prev=15,t.buttonDisabled=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[1,11,15,18]])})))()}},computed:{getFullName:function(){var t=this.form,e=t.first_name,n=t.last_name,a=t.patronymic;return"".concat(e," ").concat(n," ").concat(a)},getAge:function(){return m()().diff(this.form.date_birth,"years")}},created:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.id){e.next=4;break}t.formData=t.$store.state.user.userInfo,e.next=7;break;case 4:return t.isAdmin=!0,e.next=7,t.getEntity();case 7:return t.form=Object(i["a"])(Object(i["a"])({},t.formData),{},{expert_nominations:t.formData.expert_nominations.map((function(t){return t.toString()})),is_expert:t.formData.is_expert.toString()}),e.next=10,t.setNominations();case 10:t.loading=!1;case 11:case"end":return e.stop()}}),e)})))()}},v=h,x=n("2877"),g=Object(x["a"])(v,a,r,!1,null,"42b80dee",null);e["default"]=g.exports},cb27:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},["create-pass"===t.step?n("div",{staticClass:"container-back",on:{click:function(e){t.step="main"}}},[n("v-icon",{attrs:{name:"chevron-left"}}),n("div",[t._v("назад")])],1):t._e(),t._m(0),"main"===t.step?n("x-form",{staticClass:"user-application-container",attrs:{values:t.form,name:"expertForm"},on:{submit:function(e){return t.toNextStep("next")}},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}},[n("div",{staticClass:"step-1"},[n("application-form",{attrs:{items:t.items}}),n("a-row",{staticClass:"clear-class",attrs:{gutter:[0,30]}},[n("a-col",{staticClass:"inline-buttons",attrs:{md:{span:12,offset:6},xl:{span:8,offset:8},lg:{span:16,offset:4},xs:24}},[n("a-button",{staticClass:"login-form-button",attrs:{disabled:t.loading,type:"info",block:"","html-type":"submit"},on:{onSubmit:function(e){return t.toNextStep("back")}}},[t._v(" Сохранить и выйти ")]),n("a-button",{staticClass:"login-form-button",attrs:{disabled:t.loading,type:"primary",block:"","html-type":"submit"},on:{onSubmit:function(e){return t.toNextStep("next")}}},[t._v(" Сохранить и продолжить ")])],1)],1)],1)]):n("x-form",{attrs:{values:t.createPassForm,name:"pass-form"},on:{submit:t.onSubmit},model:{value:t.createPassForm,callback:function(e){t.createPassForm=e},expression:"createPassForm"}},[n("div",{staticClass:"step-2"},[n("a-row",{attrs:{gutter:[24]}},[n("a-col",{staticClass:"center",attrs:{xs:{span:24,offset:0},md:{span:12,offset:6},lg:{span:12,offset:6},xl:{span:8,offset:8}}},[n("x-input",{attrs:{label:"Придумайте пароль",type:"password",name:"password",validation:"min:8,length","error-behavior":"submit"}}),n("x-input",{attrs:{label:"Повторите пароль",type:"password",name:"password_confirm",validation:"min:8,length|confirm","validation-name":"Password confirmation","error-behavior":"submit"}}),n("a-button",{staticClass:"login-form-button",attrs:{disabled:t.loading,type:"primary",block:"","html-type":"submit"}},[t._v(" Завершить регистрацию ")])],1)],1)],1)])],1)},r=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container-title"},[n("span",{staticClass:"subtitle"},[t._v("Регистрация Эксперта")]),n("h2",{staticClass:"page-title"},[t._v("Этап 1. Основные сведения")]),n("span",{staticClass:"prompt"},[t._v("* - поля, обязательные для заполнения")])])}],i=n("5530"),s=n("1da1"),o=(n("d81d"),n("b0c0"),n("d3b7"),n("3ca3"),n("ddb0"),n("498a"),n("a9e3"),n("caad"),n("2532"),n("96cf"),n("cd3f")),c=n.n(o),u=n("1bd6"),l=n("d5f5"),m={components:{ApplicationForm:u["a"]},mixins:[l["a"]],data:function(){return{form:{email:"",first_name:"",last_name:"",expert_nominations:[],patronymic:"",phone_number:"",sphere:[]},createPassForm:{password:"",password_confirm:""},nomination:[],step:"main",loading:!1,errorsObj:{},nominationsAll:[]}},mounted:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getAllNominations();case 2:case"end":return e.stop()}}),e)})))()},methods:{getAllNominations:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("app/getEntities",{entityName:"nomination"});case 2:n=e.sent,t.nominationsAll=n.data.map((function(t){return{label:t.name,value:t.id}}));case 4:case"end":return e.stop()}}),e)})))()},cloneData:function(t){return c()(t)},toNextStep:function(t){this.afterType=t,this.step="create-pass"},toPrevStep:function(){this.step="main"},setNominations:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.nominationsBySphere[e.form.sphere].map((function(t){return e.getNominations(t)})));case 2:n=t.sent,e.nominationsAll=n.map((function(t){return{label:t.data[0].name,value:"".concat(t.data[0].id)}})),e.$formulate.setValues("expertForm",c()(Object(i["a"])(Object(i["a"])({},e.form),{},{expert_nominations:n.map((function(t){return"".concat(t.data[0].id)}))})));case 5:case"end":return t.stop()}}),t)})))()},onSubmit:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,n=t.cloneData(Object(i["a"])(Object(i["a"])({},t.form),{},{password:t.createPassForm.password,redirect:"next"})),e.next=5,t.$store.dispatch("app/saveEntity",{entityName:"expert-registration",data:n,method:"post"});case 5:return t.$router.push("/"),e.next=8,t.$swal.fire({title:"Регистрация прошла успешно",text:"На почту ".concat(n.email," было отправлено письмо. Для завершения регистрации перейдите по ссылке, указанной в письме."),confirmButtonText:"Хорошо"});case 8:e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](1),console.log(e.t0),400===(null===e.t0||void 0===e.t0||null===(a=e.t0.response)||void 0===a?void 0:a.status)?(t.step="main",t.$formulate.handle(e.t0.response.data,"expertForm")):t.$errors.showOnce("Ошибка входа");case 14:return e.prev=14,t.loading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,10,14,17]])})))()},trimWhitespacedAndToInt:function(t){for(var e in t)"string"==typeof t[e]&&(t[e]=t[e].trim()),t[e]!=Number(t[e])||t[e].includes("+")||"nomination"===e||(t[e]=Number(t[e]))},getNominations:function(t){return this.$store.dispatch("app/getEntities",{entityName:"nomination",params:{search:t}})}}},p=m,f=(n("11ff"),n("2877")),d=Object(f["a"])(p,a,r,!1,null,"3d882710",null);e["default"]=d.exports},d12a:function(t,e,n){},d5f5:function(t,e,n){"use strict";var a=n("1da1"),r=(n("96cf"),n("09bc"));e["a"]={data:function(){var t=this;return{nominationsBySphere:[["Студенческая творческая личность вуза","Студенческая творческая личность ссуза"],["Студенческий лидер ссуза","Студенческий лидер вуза","Староста года"],["Доброволец года","Добровольческое объединение"],["Спортсмен года вуза","Спортсмен года ссуза"],["Студенческое СМИ года"],["Интеллект года"],["Патриотическое объединение года"],["Молодой профессионал года"]],items:[[{name:"first_name",validation:"required",type:"text",label:"Фамилия",md:8},{name:"last_name",validation:"required",type:"text",label:"Имя",md:8},{name:"patronymic",type:"text",label:"Отчество",md:8}],[{name:"email",validation:"required",type:"text",label:"Email"},{name:"phone_number",validation:[["required"],["min","18"]],mask:"+7 (###) ###-##-##",type:"tel",label:"Номер телефона",xl:16}],[{name:"sphere",validation:"required",label:"Направление",type:"select",options:r["h"],change:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.setNominations();case 2:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}(),xl:8,md:8},{name:"expert_nominations",validation:"required",label:"Номинация",type:"vue-select",multiple:!0,disabled:!0,class:function(){return t.form.nomination.length>=1?"has-all":""},options:function(){return t.nominationsAll},xl:16,md:16}]]}}}}}]);